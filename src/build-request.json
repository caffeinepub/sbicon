{
  "kind": "build_request",
  "title": "Improve custom domain onboarding and website sharing flow",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Add a guided \"Custom Domain\" input and validation flow in the existing Publishing & Share page so users can enter the exact domain they own and see a clean, canonical URL to use for `VITE_PUBLIC_URL`.\n\nThe flow must:\n- Provide an input that accepts either a bare domain (e.g., `example.com`) or an HTTPS URL (e.g., `https://example.com`).\n- Reject and show an English error message for:\n  - URLs containing a path, querystring, or fragment (e.g., `https://example.com/page?x=1`).\n  - Well-known third-party domains the user clearly does not own (at minimum block `google.com` and `www.google.com`).\n- Normalize the accepted value into a canonical HTTPS URL (e.g., `example.com` -> `https://example.com`, `https://example.com/` -> `https://example.com`).\n- Display a copy-to-clipboard control that copies an `.env` snippet line in the exact form: `VITE_PUBLIC_URL=https://example.com`.\n- Persist the entered domain value locally (e.g., localStorage) so it remains visible across reloads.\n- Include clear English guidance stating that changing the domain in the UI does not automatically connect DNS; the user must configure DNS at their registrar and then rebuild/redeploy with `VITE_PUBLIC_URL` set.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-14",
          "msg-10",
          "msg-12"
        ],
        "quotes": [
          "do my website",
          "google",
          "https://www.google.com/?zx=1770337776015&no_sw_cr=1"
        ]
      },
      "acceptanceCriteria": [
        "On the Publishing & Share page, users can enter a domain/URL and see the normalized canonical URL output.",
        "If the user enters a URL with a path/query/fragment, the UI shows an English validation error and does not accept the value.",
        "If the user enters `google.com` or `www.google.com` (with or without `https://`), the UI blocks it with an English explanation that they must use a domain they own.",
        "A \"Copy\" action copies the exact string `VITE_PUBLIC_URL=https://<domain>` corresponding to the normalized canonical URL.",
        "The entered domain is restored after a page refresh.",
        "No immutable frontend paths are modified."
      ]
    }
  ],
  "constraints": [
    "Do not modify any files under `frontend/src/components/ui` (compose existing UI components only).",
    "Do not modify any files listed as immutable in SYSTEM_CONTEXT.",
    "Do not imply or implement automatic domain purchasing/registration or automatic DNS changes; only provide guidance and local configuration helpers."
  ],
  "nonGoals": [
    "Actually connecting a custom domain at the registrar/DNS provider from within the app.",
    "Supporting third-party domains the user does not own (e.g., using `google.com` as the site domain).",
    "Adding new backend canisters or external services."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}